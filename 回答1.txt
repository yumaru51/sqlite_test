from django.apps import apps

app_name = 'myapp'
model_name = 'MyModel'

MyModel = apps.get_model(app_name, model_name)




from django.apps import apps

# Excelファイル読込
workbook = openpyxl.load_workbook(file_name + '.xlsx')
worksheet = workbook.active

# モデルの取得
app_name = 'myapp'
model_name = file_name.capitalize()
MyModel = apps.get_model(app_name, model_name)

# 項目の取得
for cell in worksheet[1]:
    column_names.append(cell.value)
print(file_name + 'を処理しています')
print(column_names)

# IMPORT処理
for column_data in worksheet.iter_rows(min_row=2):
    kwargs = {column_names[i]: column_data[i].value for i in range(len(column_names))}
    MyModel.objects.create(**kwargs)

# リセット
column_names = []
