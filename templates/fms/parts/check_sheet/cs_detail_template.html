{% extends 'fms/fms_base.html' %}

{% block contents %}

<script>
//タブ表示のためのJS
var tab = {
	init: function(a){
		var tabs = this.setup.tabs;
		var pages = this.setup.pages;
		var show_page_id = 'page' + a;
		for(i=0; i<pages.length; i++) {
			if(pages[i] != null) {
			    if( pages[i].id == show_page_id ) {
                    pages[i].style.display = 'block';
                    tabs[i].className = 'present';
                    tabs[i].onclick = function(){ tab.showpage(this); return false; };
                }
                else{
                    pages[i].style.display = 'none';
                    tabs[i].className = null;
                    tabs[i].onclick = function(){ tab.showpage(this); return false; };
                }
            }
		}
	},
	showpage: function(obj){
		var tabs = this.setup.tabs;
		var pages = this.setup.pages;
		var num;
		for(num=0; num<tabs.length; num++) {
			if(tabs[num] === obj) break;
		}
		for(var i=0; i<pages.length; i++) {
		    if(pages[i] != null) {
                if(i == num) {
                    pages[num].style.display = 'block';
                    tabs[num].className = 'present';
                }
                else{
                    pages[i].style.display = 'none';
                    tabs[i].className = null;
                }
            }
		}
	}
}
//予算IDのコンボボックスの選択を呼び出した値(引数?)と同期
function budget_id_value_change() {
    var target_budget_id = $('#target_budget_id').val();
    if (target_budget_id != "") {
        var pulldown_option = document.getElementById("sel_budget_id").getElementsByTagName('option');
        var i = 0;
        for(i=0;pulldown_option.length>i;i++){
            if(pulldown_option[i].value == target_budget_id){
                var value = pulldown_option[i].value;
                pulldown_option[i].selected = true;
                break;
            }
        }
    }
}

//予算IDのコンボボックスを変更したときに選択値と格納値を同期
function budget_id_change(a, budget_id_list) {
    var value = a;
    id = $('[name=sel_budget_id] option:selected')[0].id
    $('#target_budget_id').val(value);
    $('#target_budget_unique_id').val(id);
    budget_detail_info();
}

//フィルタ条件変更時処理
function cs_budget_id_filter() {
    var business_year = $('#sel_cs_business_year').val();
    var budget_id = $('#sel_cs_budget_id').val();
    var budget_no = $('#sel_cs_budget_no').val();
    var division = $('#sel_cs_division').val();
    var department = $('#sel_cs_department').val();
    var budget_class = $('#sel_cs_budget_class').val();
            $.ajax({
                url: "/isk_tools/fms/parts/check_sheet/cs_detail/cs_budget_id_filter/",
                type: "POST",
                data : {
                    'business_year': business_year,
                    'budget_id': budget_id,
                    'budget_no': budget_no,
                    'division': division,
                    'department': department,
                    'budget_class': budget_class,
                    'csrfmiddlewaretoken': "{{ csrf_token }}"
                },
                timeout: 10000,
                dataType: 'html',
                cache : false,
                })
                .done(function(data){
                    $('#cs_sel_budget_id').empty();
                    $('#cs_sel_budget_id').html(data);
                })
               .fail(function(jqXHR,textStatus,errorThrown){
                    $('#cs_sel_budget_id').empty();
                    alert('Error!' +textStatus+' ' +errorThrown);
                });
}

function cs_department_list_filter(division){
    var division = division;
            $.ajax({
                url: "/isk_tools/fms/parts/check_sheet/cs_detail/cs_department_list_filter/",
                type: "POST",
                data : {
                    'division' : division,
                    'csrfmiddlewaretoken': "{{ csrf_token }}"
                },
                timeout: 10000,
                dataType: 'html',
                cache : false,
                })
                .done(function(data){
                    $(cs_filter_department).empty();
                    $(cs_filter_department).html(data);
                    cs_budget_id_filter();
                })
               .fail(function(jqXHR,textStatus,errorThrown){
                    $(cs_filter_department).empty();
                    alert('Error!' +textStatus+' ' +errorThrown);
                });
}

//関連法令一覧を表示するためのJS
function cs_related_laws_lists_info() {
    if (document.getElementById("cs_related_laws_lists") != null) {
        var target_unique_id = $('#target_unique_id').val();
        var budget_id = $('#target_budget_id').val();
        //var work_id = $('#work_id').val();
        var user_division_cd = $('#user_division_cd').val();
        var user_department_cd = $('#user_department_cd').val();
        var user_authority = $('#user_authority').val();
        var confirm_user = $('#confirm_user').val();
        var permit_user = $('#permit_user').val();
        var level5_step_id = $('#level5_step_id').val();
        var this_step = $('#this_step').val();
        var new_step = Number(level5_step_id) + 1;
        $.ajax({
                url: "/isk_tools/fms/parts/check_sheet/cs_detail/cs_related_laws_list_info/",
                type: "POST",
                data : {
                    'target_unique_id': target_unique_id,
                    'budget_id': budget_id,
                    //'work_id': work_id,
                    'this_step' : this_step,
                    'new_step' : new_step,
                    'user_division_cd' : user_division_cd,
                    'user_department_cd' : user_department_cd,
                    'user_authority' : user_authority,
                    'confirm_user' : confirm_user,
                    'permit_user' : permit_user,
                    'level5_step_id' : level5_step_id,
                    'csrfmiddlewaretoken': "{{ csrf_token }}"
                },
                timeout: 10000,
                dataType: 'html',
                cache : false,
                })
                .done(function(data){
                    $('#cs_related_laws_lists').empty();
                    $('#cs_related_laws_lists').html(data);

                    if (document.getElementById("work_common_detail") == null) {//工事詳細情報を表示するためのdivがないか判定
                        log_list(4);//ログ表示(予算単位デフォルト)のためのJS起動(このhtml内にプログラム有)
                    }

                })
               .fail(function(jqXHR,textStatus,errorThrown){
                    //$('#cs_detail').empty();
                    $('#cs_related_laws_lists').empty();
                    alert('Error!' +textStatus+' ' +errorThrown);
                });
    }
}

//予算詳細情報を表示するためのJS
function budget_detail_info() {
    if (document.getElementById("budget_detail") != null) {
        var id = $('#target_budget_unique_id').val();
        var user_division_cd = $('#user_division_cd').val();
        var user_department_cd = $('#user_department_cd').val();
        var user_authority = $('#user_authority').val();
        var confirm_user = $('#confirm_user').val();
        var permit_user = $('#permit_user').val();
        var level5_step_id = $('#level5_step_id').val();
        var new_step = Number(level5_step_id) + 1;
        var target = $('#target').val();
        var target_step_id = $('#target_step_id').val();
        var target_budget_id = $('#target_budget_id').val();
        var target_work_id = $('#target_work_id').val();
        var div_id_name = "budget_detail";
        $.ajax({
                url: "/isk_tools/fms/parts/budget/budget_detail/budget_data_info/",
                type: "POST",
                data : {
                    'id': id,
                    'new_step' : new_step,
                    'user_division_cd' : user_division_cd,
                    'user_department_cd' : user_department_cd,
                    'user_authority' : user_authority,
                    'confirm_user' : confirm_user,
                    'permit_user' : permit_user,
                    'level5_step_id' : level5_step_id,
                    'target': target,
                    'target_step_id': target_step_id,
                    'target_budget_id': target_budget_id,
                    'target_work_id': target_work_id,
                    'div_id_name': div_id_name,
                    'csrfmiddlewaretoken': "{{ csrf_token }}"
                },
                timeout: 10000,
                dataType: 'html',
                cache : false,
                })
                .done(function(data){
                    $('#budget_detail').empty();
                    $('#budget_detail').html(data);
                    get_budget_law_list_in_info();//予算関係法令の一覧を表示するJS起動(このhtml内にプログラム有)
                    get_budget_equipment_list_in_info();//予算関係機器の一覧を表示するJS起動(このhtml内にプログラム有)

                })
               .fail(function(jqXHR,textStatus,errorThrown){
                    $('#budget_detail').empty();
                    alert('Error!' +textStatus+' ' +errorThrown);
                });
    }
}
//予算関係法令一覧の表示処理(予算情報表示時にbudget_info.htmlを使用したとき用)
function get_budget_law_list_in_info() {
    if (document.getElementById("budget_law_list_in_info") != null) {
        var budget_id = $('#target_budget_id').val();
        var select_pb_disp_flag = 0;
            $.ajax({
                url: "/isk_tools/fms/parts/law_equipment/budget_law_list/",
                type: "POST",
                data : {
                    'budget_id' : budget_id,
                    'select_pb_disp_flag' : select_pb_disp_flag,
                    'csrfmiddlewaretoken': "{{ csrf_token }}"
                },
                timeout: 10000,
                dataType: 'html',
                cache : false,
                })
                .done(function(data){
                    $('#budget_law_list_in_info').empty();
                    $('#budget_law_list_in_info').html(data);
               })
               .fail(function(jqXHR,textStatus,errorThrown){
                    $('#budget_law_list_in_info').empty();
                    alert('Error!' +textStatus+' ' +errorThrown);
               });
    }
}
//予算関係機器一覧の表示処理(予算情報表示時にbudget_info.htmlを使用したとき用)
function get_budget_equipment_list_in_info() {
    if (document.getElementById("budget_equipment_list_in_info") != null) {
        var budget_id = $('#target_budget_id').val();
        var select_pb_disp_flag = 0;
            $.ajax({
                url: "/isk_tools/fms/parts/law_equipment/budget_equipment_list/",
                type: "POST",
                data : {
                    'budget_id' : budget_id,
                    'select_pb_disp_flag' : select_pb_disp_flag,
                    'csrfmiddlewaretoken': "{{ csrf_token }}"
                },
                timeout: 10000,
                dataType: 'html',
                cache : false,
                })
                .done(function(data){
                    $('#budget_equipment_list_in_info').empty();
                    $('#budget_equipment_list_in_info').html(data);
               })
               .fail(function(jqXHR,textStatus,errorThrown){
                    $('#budget_equipment_list_in_info').empty();
                    alert('Error!' +textStatus+' ' +errorThrown);
               });
    }
}

//総務管轄届け出チェックシート情報を表示するためのJS
function cs_general_affairs_info() {
    if (document.getElementById("cs_detail") != null) {
        var target_unique_id = $('#target_unique_id').val();
        var budget_id = $('#target_budget_id').val();
        //var work_id = $('#work_id').val();
        var user_division_cd = $('#user_division_cd').val();
        var user_department_cd = $('#user_department_cd').val();
        var user_authority = $('#user_authority').val();
        var confirm_user = $('#confirm_user').val();
        var permit_user = $('#permit_user').val();
        var level5_step_id = $('#level5_step_id').val();
        var this_step = $('#this_step').val();
        var new_step = Number(level5_step_id) + 1;
        var div_id_name = "cs_detail";
        $.ajax({
                url: "/isk_tools/fms/parts/check_sheet/cs_detail/cs_data_info/",
                type: "POST",
                data : {
                    'target_unique_id': target_unique_id,
                    'budget_id': budget_id,
                    //'work_id': work_id,
                    'this_step': this_step,
                    'new_step' : new_step,
                    'user_division_cd' : user_division_cd,
                    'user_department_cd' : user_department_cd,
                    'user_authority' : user_authority,
                    'confirm_user' : confirm_user,
                    'permit_user' : permit_user,
                    'level5_step_id' : level5_step_id,
                    'div_id_name': div_id_name,
                    'csrfmiddlewaretoken': "{{ csrf_token }}"
                },
                timeout: 10000,
                dataType: 'html',
                cache : false,
                })
                .done(function(data){
                    $('#cs_detail').empty();
                    $('#cs_detail').html(data);

                    if (document.getElementById("work_common_detail") == null) {//工事詳細情報を表示するためのdivがないか判定
                        log_list(4);//ログ表示(予算単位デフォルト)のためのJS起動(このhtml内にプログラム有)
                    }

                    var edit_flag = document.getElementById('ga_edit_flag').value;
                    if (edit_flag == "1")
                    {
                        factory_location_act_motive_value_change();//工場立地法のコンボボックスの選択を呼び出した値(引数?)と同期
                    }

                    cs_ga_check_box_change();// チェックボックスの状態同期
                })
               .fail(function(jqXHR,textStatus,errorThrown){
                    $('#cs_detail').empty();
                    alert('Error!' +textStatus+' ' +errorThrown);
                });
    }
}

//安全衛生管轄届け出チェックシート情報を表示するためのJS
function cs_safety_health_data_info() {
    if (document.getElementById("cs_safety_health") != null) {
        var target_unique_id = $('#target_unique_id').val();
        var budget_id = $('#target_budget_id').val();
        //var work_id = $('#work_id').val();
        var user_division_cd = $('#user_division_cd').val();
        var user_department_cd = $('#user_department_cd').val();
        var user_authority = $('#user_authority').val();
        var confirm_user = $('#confirm_user').val();
        var permit_user = $('#permit_user').val();
        var level5_step_id = $('#level5_step_id').val();
        var this_step = $('#this_step').val();
        var new_step = Number(level5_step_id) + 1;
        var div_id_name = "cs_safety_health";
        $.ajax({
                url: "/isk_tools/fms/parts/check_sheet/cs_detail/cs_safety_health_data_info/",
                type: "POST",
                data : {
                    'target_unique_id': target_unique_id,
                    'budget_id': budget_id,
                    //'work_id': work_id,
                    'this_step': this_step,
                    'new_step' : new_step,
                    'user_division_cd' : user_division_cd,
                    'user_department_cd' : user_department_cd,
                    'user_authority' : user_authority,
                    'confirm_user' : confirm_user,
                    'permit_user' : permit_user,
                    'level5_step_id' : level5_step_id,
                    'div_id_name': div_id_name,
                    'csrfmiddlewaretoken': "{{ csrf_token }}"
                },
                timeout: 10000,
                dataType: 'html',
                cache : false,
                })
                .done(function(data){
                    $('#cs_safety_health').empty();
                    $('#cs_safety_health').html(data);

                    if (document.getElementById("work_common_detail") == null) {//工事詳細情報を表示するためのdivがないか判定
                        log_list(4);//ログ表示(予算単位デフォルト)のためのJS起動(このhtml内にプログラム有)
                    }

                    var edit_flag = document.getElementById('sh_edit_flag').value;
                    if (edit_flag == "1")
                    {
                        fire_service_app_place_value_change();//消防法_危険物承認申請_場所のコンボボックスの選択を呼び出した値(引数?)と同期
                        fire_service_app_action_value_change();//消防法_危険物承認申請_扱いのコンボボックスの選択を呼び出した値(引数?)と同期
                        fire_service_ntfc_place_value_change();//消防法_危険物届_場所のコンボボックスの選択を呼び出した値(引数?)と同期
                        fire_service_ntfc_amendment_value_change();//消防法_危険物届_改廃のコンボボックスの選択を呼び出した値(引数?)と同期
                        fire_service_quantity_ntfc_place_value_change();//消防法_危険物品名数量倍数変更届_場所のコンボボックスの選択を呼び出した値(引数?)と同期
                        fire_service_acetylene_gas_ntfc_amendment_value_change();//消防法_圧縮アセチレンガス等貯蔵取扱届_改廃のコンボボックスの選択を呼び出した値(引数?)と同期
                        fire_service_tentative_app_action_value_change();//消防法_危険物仮承認申請_扱いのコンボボックスの選択を呼び出した値(引数?)と同期
                        fire_prevent_storage_ntfc_category_value_change();//市火災予防条例_危険物貯蔵取扱届_危険物種類のコンボボックスの選択を呼び出した値(引数?)と同期
                        fire_prevent_storage_ntfc_amendment_value_change();//市火災予防条例_危険物貯蔵取扱届_改廃のコンボボックスの選択を呼び出した値(引数?)と同期
                        fire_prevent_equip_ntfc_category_value_change();//市火災予防条例_設備設置届_設備種類のコンボボックスの選択を呼び出した値(引数?)と同期
                        deleterious_substances_ntfc_purpose_value_change();//劇毒物取締法_劇毒物変更届_取扱のコンボボックスの選択を呼び出した値(引数?)と同期
                        press_gas_app_motive_value_change();//高圧ガス保安法_特定高圧ガス設備申請_設置/変更のコンボボックスの選択を呼び出した値(引数?)と同期
                        press_gas_lpg_app_motive_value_change();//高圧ガス保安法_液化石油高圧ガス設備申請_設置/変更のコンボボックスの選択を呼び出した値(引数?)と同期
                        press_gas_frozen_gas_app_motive_value_change();//高圧ガス保安法_冷凍高圧ガス設備申請_設置/変更のコンボボックスの選択を呼び出した値(引数?)と同期
                        press_gas_ntfc_amendment_value_change();//高圧ガス保安法_特定高圧ガス設備届_改廃のコンボボックスの選択を呼び出した値(引数?)と同期
                        press_gas_lpg_ntfc_amendment_value_change();//高圧ガス保安法_液化石油高圧ガス設備届_改廃のコンボボックスの選択を呼び出した値(引数?)と同期
                        press_gas_frozen_gas_ntfc_amendment_value_change();//高圧ガス保安法_冷凍高圧ガス設備届_改廃のコンボボックスの選択を呼び出した値(引数?)と同期
                        press_gas_consumption_ntfc_amendment_value_change();//高圧ガス保安法_特定高圧ガス消費設備届_改廃のコンボボックスの選択を呼び出した値(引数?)と同期
                        safety_health_equip_ntfc_category_value_change();//労働安全衛生法_設置物届_設置物種類のコンボボックスの選択を呼び出した値(引数?)と同期
                        safety_health_equip_ntfc_motive_value_change();//労働安全衛生法_設置物届_設置/変更のコンボボックスの選択を呼び出した値(引数?)と同期
                        safety_health_deleterious_ntfc_category_value_change();//労働安全衛生法_有害物質届_有害物質種類のコンボボックスの選択を呼び出した値(引数?)と同期
                        safety_health_deleterious_ntfc_motive_value_change();//労働安全衛生法_有害物質届_設置/変更のコンボボックスの選択を呼び出した値(引数?)と同期
                        safety_health_specified_equip_ntfc_category_value_change();//労働安全衛生法_設備届_設備種類のコンボボックスの選択を呼び出した値(引数?)と同期
                        safety_health_specified_equip_ntfc_motive_value_change();//労働安全衛生法_設備届_設置/変更のコンボボックスの選択を呼び出した値(引数?)と同期
                        safety_health_installation_report_category_value_change();//労働安全衛生法_設備設置報告_設備種類のコンボボックスの選択を呼び出した値(引数?)と同期
                        radiation_hazards_app_motive_value_change();//放射線障害防止法_放射性同位元素申請_使用/変更のコンボボックスの選択を呼び出した値(引数?)と同期


                    }

                    cs_sh_check_box_change();// チェックボックスの状態同期

                })
               .fail(function(jqXHR,textStatus,errorThrown){
                    $('#cs_detail').empty();
                    alert('Error!' +textStatus+' ' +errorThrown);
                });
    }
}

//環境管轄届け出チェックシート情報を表示するためのJS
function cs_environment_data_info() {
    if (document.getElementById("cs_environment") != null) {
        var target_unique_id = $('#target_unique_id').val();
        var budget_id = $('#target_budget_id').val();
        //var work_id = $('#work_id').val();
        var user_division_cd = $('#user_division_cd').val();
        var user_department_cd = $('#user_department_cd').val();
        var user_authority = $('#user_authority').val();
        var confirm_user = $('#confirm_user').val();
        var permit_user = $('#permit_user').val();
        var level5_step_id = $('#level5_step_id').val();
        var this_step = $('#this_step').val();
        var new_step = Number(level5_step_id) + 1;
        var div_id_name = "cs_environment";
        $.ajax({
                url: "/isk_tools/fms/parts/check_sheet/cs_detail/cs_environment_data_info/",
                type: "POST",
                data : {
                    'target_unique_id': target_unique_id,
                    'budget_id': budget_id,
                    //'work_id': work_id,
                    'this_step': this_step,
                    'new_step' : new_step,
                    'user_division_cd' : user_division_cd,
                    'user_department_cd' : user_department_cd,
                    'user_authority' : user_authority,
                    'confirm_user' : confirm_user,
                    'permit_user' : permit_user,
                    'level5_step_id' : level5_step_id,
                    'div_id_name': div_id_name,
                    'csrfmiddlewaretoken': "{{ csrf_token }}"
                },
                timeout: 10000,
                dataType: 'html',
                cache : false,
                })
                .done(function(data){
                    $('#cs_environment').empty();
                    $('#cs_environment').html(data);

                    if (document.getElementById("work_common_detail") == null) {//工事詳細情報を表示するためのdivがないか判定
                        log_list(4);//ログ表示(予算単位デフォルト)のためのJS起動(このhtml内にプログラム有)
                    }

                    var edit_flag = document.getElementById('env_edit_flag').value;
                    if (edit_flag == "1")
                    {
                        air_pollution_equip_ntfc_category_value_change()//大気汚染防止法_大気汚染物質発生施設届_種類のコンボボックスの選択を呼び出した値(引数?)と同期
                        air_pollution_equip_ntfc_motive_value_change()//大気汚染防止法_大気汚染物質発生施設届_設置/変更のコンボボックスの選択を呼び出した値(引数?)と同期
                        air_pollution_repeal_equip_ntfc_category_value_change()//大気汚染防止法_大気汚染物質発生施設廃止届_種類のコンボボックスの選択を呼び出した値(引数?)と同期
                        air_pollution_voc_ntfc_action_value_change()//大気汚染防止法_揮発性有機化合物発生施設届_扱いのコンボボックスの選択を呼び出した値(引数?)と同期
                        water_pollution_ntfc_action_value_change()//水質汚濁防止法_特定施設届_扱いのコンボボックスの選択を呼び出した値(引数?)と同期
                        waste_equip_app_motive_value_change()//廃棄物処理法_産業廃棄物処理施設申請_設置/変更のコンボボックスの選択を呼び出した値(引数?)と同期
                        living_env_equip_ntfc_category_value_change()//県生活環境保全条例_指定施設届_種類のコンボボックスの選択を呼び出した値(引数?)と同期
                        living_env_equip_ntfc_action_value_change()//県生活環境保全条例_指定施設届_扱いのコンボボックスの選択を呼び出した値(引数?)と同期
                        water_purification_tanks_ntfc_amendment_value_change()//浄化槽法_浄化槽届出_改廃のコンボボックスの選択を呼び出した値(引数?)と同期

                    }

                    cs_env_check_box_change();// チェックボックスの状態同期

                })
               .fail(function(jqXHR,textStatus,errorThrown){
                    $('#cs_detail').empty();
                    alert('Error!' +textStatus+' ' +errorThrown);
                });
    }
}

//工務管轄届け出チェックシート情報を表示するためのJS
function cs_engineering_data_info() {
    if (document.getElementById("cs_engineering") != null) {
        var target_unique_id = $('#target_unique_id').val();
        var budget_id = $('#target_budget_id').val();
        //var work_id = $('#work_id').val();
        var user_division_cd = $('#user_division_cd').val();
        var user_department_cd = $('#user_department_cd').val();
        var user_authority = $('#user_authority').val();
        var confirm_user = $('#confirm_user').val();
        var permit_user = $('#permit_user').val();
        var level5_step_id = $('#level5_step_id').val();
        var this_step = $('#this_step').val();
        var new_step = Number(level5_step_id) + 1;
        var div_id_name = "cs_engineering";
        $.ajax({
                url: "/isk_tools/fms/parts/check_sheet/cs_detail/cs_engineering_data_info/",
                type: "POST",
                data : {
                    'target_unique_id': target_unique_id,
                    'budget_id': budget_id,
                    //'work_id': work_id,
                    'this_step': this_step,
                    'new_step' : new_step,
                    'user_division_cd' : user_division_cd,
                    'user_department_cd' : user_department_cd,
                    'user_authority' : user_authority,
                    'confirm_user' : confirm_user,
                    'permit_user' : permit_user,
                    'level5_step_id' : level5_step_id,
                    'div_id_name': div_id_name,
                    'csrfmiddlewaretoken': "{{ csrf_token }}"
                },
                timeout: 10000,
                dataType: 'html',
                cache : false,
                })
                .done(function(data){
                    $('#cs_engineering').empty();
                    $('#cs_engineering').html(data);

                    if (document.getElementById("work_common_detail") == null) {//工事詳細情報を表示するためのdivがないか判定
                        log_list(4);//ログ表示(予算単位デフォルト)のためのJS起動(このhtml内にプログラム有)
                    }

                    var edit_flag = document.getElementById('eng_edit_flag').value;
                    if (edit_flag == "1")
                    {
                        building_standards_act_category_value_change() // 建築基準法_確認申請_種類のコンボボックスの選択を呼び出した値(引数?)と同期
                        energy_rationalization_act_category_value_change() // 省エネ法_特定建築物届出_種類のコンボボックスの選択を呼び出した値(引数?)と同期
                        energy_rationalization_act_action_value_change() //省エネ法_特定建築物届出_扱いのコンボボックスの選択を呼び出した値(引数?)と同期
                        construction_recycling_category_value_change()//建設リサイクル法_種類のコンボボックスの選択を呼び出した値(引数?)と同期

                    }

                    cs_eng_check_box_change();// チェックボックスの状態同期

                })
               .fail(function(jqXHR,textStatus,errorThrown){
                    $('#cs_detail').empty();
                    alert('Error!' +textStatus+' ' +errorThrown);
                });
    }
}
//届け出チェックシート部署単位log情報を表示するためのJS
function cs_log_info() {
    //if (document.getElementById("cs_log") != null) {
        var target_id = $('#target_id').val();
        $.ajax({
                url: "/isk_tools/fms/parts/check_sheet/cs_detail/cs_log/",
                type: "POST",
                data : {
                    'target_id': target_id,
                    'csrfmiddlewaretoken': "{{ csrf_token }}"
                },
                timeout: 10000,
                dataType: 'html',
                cache : false,
                })
                .done(function(data){
                    $('#cs_log_lists').empty();
                    $('#cs_log_lists').html(data);
                })
               .fail(function(jqXHR,textStatus,errorThrown){
                    $('#cs_log_lists').empty();
                    alert('Error!' +textStatus+' ' +errorThrown);
                });
    //}
}
//操作ボタン部分の表示処理
function action_button_display() {
        var target_id = $('#target_id').val();
        var budget_id = $('#target_budget_id').val();
        var next_department = $('#next_department').val();
        var next_division = $('#next_division').val();
        var target_table = "cs";
        var level5_step_id = $('#level5_step_id').val();
        var permit_user = $('#permit_user').val();
        var target_step_id = $('#target_step_id').val();
        var user_department_cd = $('#user_department_cd').val();
        var last_operation_step = $('#last_operation_step').val();
        var target = $('#target').val();
        var target_div_id = "#" + target + "_action_button";
        var start_work_stop_flag = Number($('#start_work_stop_flag').val());
        if(isNaN(start_work_stop_flag)){
            start_work_stop_flag = 0;
        }
        $.ajax({
                url: "/isk_tools/fms/parts/common/action_button_display/",
                type: "POST",
                data : {
                    'next_department' : next_department,
                    'next_division' : next_division,
                    'target_budget_id' : budget_id,
                    'target_table' : target_table,
                    'target_id' : target_id,
                    'level5_step_id' : level5_step_id,
                    'permit_user' : permit_user,
                    'target_step_id' : target_step_id,
                    'user_department_cd' : user_department_cd,
                    'last_operation_step' : last_operation_step,
                    'target' : target,
                    'start_work_stop_flag' : start_work_stop_flag,
                    'csrfmiddlewaretoken': "{{ csrf_token }}"
                },
                timeout: 10000,
                dataType: 'html',
                cache : false,
                })
                .done(function(data){
                    $(target_div_id).empty();
                    $(target_div_id).html(data);
                    {% if target_step_id == 134001011 or target_step_id == 135001011 %}
                        if(document.getElementById("next_step_select") != null){
                            document.getElementById("next_step_select").style.display ="none";
                        }
                    {% endif %}
                })
               .fail(function(jqXHR,textStatus,errorThrown){
                    $(target_div_id).empty();
                    alert('Error!' +textStatus+' ' +errorThrown);
                });
}

//ログリストの表示処理
function log_list(a) {
    if (document.getElementById("log_lists") != null) {
        var log_source = a;
        var target_budget_id = $('#target_budget_id').val();
        var this_target = $('#target').val();
        if (log_source == 1) {
            var target_id = $('#target_budget_id').val();
            var target = "budget";
        }
        if (log_source == 2) {
            var target_id = $('#target_work_id').val();
            var target = "work";
        }
        if (log_source == 3) {
            var target_id = $('#target_budget_id').val();
            var target = "budget";
        }
        if (log_source == 4) {
            var target_id = $('#target_id').val();
            var target = "cs";
        }
        if (log_source == 9) {
            var target_id = $('#target_budget_id').val();
            var target = "budget";
        }
        $.ajax({
                url: "/isk_tools/fms/parts/common/log_list/",
                type: "POST",
                data : {
                    'target_id': target_id,
                    'target': target,
                    'log_source': log_source,
                    'target_budget_id': target_budget_id,
                    'this_target': this_target,
                    'csrfmiddlewaretoken': "{{ csrf_token }}"
                },
                timeout: 10000,
                dataType: 'html',
                cache : false,
                })
                .done(function(data){
                    $('#log_lists').empty();
                    $('#log_lists').html(data);
                    log_class_value(log_source);//ログリストの対象を選択する「id=log_class」のvalueを同期するJS起動(log.html内にプログラム有)
                })
               .fail(function(jqXHR,textStatus,errorThrown){
                    $('#log_lists').empty();
                    alert('Error!' +textStatus+' ' +errorThrown);
                });
    }
}
/*
ここは「fms_base.html」に記載されているのでコメント化･･･将来削除予定
//レベル4のトップページの表示処理(引数a=レベル3の工程ID)
function level4_toppage(a) {
    var user_division_cd = $('#user_division_cd').val();
    var user_department_cd = $('#user_department_cd').val();
    var user_authority = $('#user_authority').val();
    var confirm_user = $('#confirm_user').val();
    var permit_user = $('#permit_user').val();
    $('<form/>', {action: '../../level4_step_top/', method: 'post'})
    .append($('<input/>', {type: 'hidden', name: 'level4_step_id', value: a}))
    .append($('<input/>', {type: 'hidden', name: 'user_division_cd', value: user_division_cd}))
    .append($('<input/>', {type: 'hidden', name: 'user_department_cd', value: user_department_cd}))
    .append($('<input/>', {type: 'hidden', name: 'user_authority', value: user_authority}))
    .append($('<input/>', {type: 'hidden', name: 'confirm_user', value: confirm_user}))
    .append($('<input/>', {type: 'hidden', name: 'permit_user', value: permit_user}))
    .append($('<input/>', {type: 'hidden', name: 'csrfmiddlewaretoken', value: '{{ csrf_token }}'}))
    .appendTo(document.body)
    .submit();
}

//レベル5のトップページの表示処理(引数a=レベル4の工程ID)
function level5_toppage(a) {
    var user_division_cd = $('#user_division_cd').val();
    var user_department_cd = $('#user_department_cd').val();
    var user_authority = $('#user_authority').val();
    var confirm_user = $('#confirm_user').val();
    var permit_user = $('#permit_user').val();
    var select_tab = $('#select_tab').val();
    $('<form/>', {action: '../../../level5_step_top/', method: 'post'})
    .append($('<input/>', {type: 'hidden', name: 'level5_step_id', value: a}))
    .append($('<input/>', {type: 'hidden', name: 'user_division_cd', value: user_division_cd}))
    .append($('<input/>', {type: 'hidden', name: 'user_department_cd', value: user_department_cd}))
    .append($('<input/>', {type: 'hidden', name: 'user_authority', value: user_authority}))
    .append($('<input/>', {type: 'hidden', name: 'confirm_user', value: confirm_user}))
    .append($('<input/>', {type: 'hidden', name: 'permit_user', value: permit_user}))
    .append($('<input/>', {type: 'hidden', name: 'select_tab', value: select_tab}))
    .append($('<input/>', {type: 'hidden', name: 'csrfmiddlewaretoken', value: '{{ csrf_token }}'}))
    .appendTo(document.body)
    .submit();
}
*/
//表示するタブを切り替える処理
function tub_change(a) {
    var i = a;
    tab.init(i);
}
//入力項目の未入力、文字数オーバーをチェック
function input_check(a,b,d) {  // a:自工程id, b:次工程id,  d:action_cd
    var ng_flag = 0;
    var ng_str_count_flag = 0;
    var ng_count = 0;
    var result = 0;
    var msg = "";
    var alert_ng_ch_msg_str = ""

    if ($('#budget_id_edit_flg').val() == 1){
        // 見積ID
        if ($('#sel_budget_id').val() == ""){
            $('#sel_budget_id').css('background-color','orange');
            ng_flag = ng_flag + 1 ;
        }else{
            $('#sel_budget_id').css('background-color','white');
        }

        // 全て正常時のみ禁止文字チェック
        var ng_all_flag = ng_flag + ng_str_count_flag;
        if ( ng_all_flag == 0) {
            alert_ng_ch_msg_str = check_all_ng_character("{{ div_id_name }}_ng_character_check");
        }
        //警告表示
        if ( ng_flag > 0 ) {
            msg += '共通表示項目にて未入力項目があります！！\n';
        }
        if ( ng_str_count_flag > 0 ) {
            msg += '共通表示項目にて文字数オーバーの項目があります\n';
        }
        if ( alert_ng_ch_msg_str.length > 0 ) {
            msg += alert_ng_ch_msg_str;
        }
        if ( msg.length > 0 ) {
            alert(msg);
        }
        ng_count = ng_flag + ng_str_count_flag + alert_ng_ch_msg_str.length;
    }

    //if(ng_count == 0 && a != b)
    //{
        //delete_cs_notification_progress();
    //}
    if ($('#ga_edit_flag').val() == 1){
        ng_count += input_ga_check(a,b,d);
    }
    if ($('#sh_edit_flag').val() == 1){
        ng_count += input_sh_check(a,b,d);
    }
    if ($('#env_edit_flag').val() == 1){
        ng_count += input_env_check(a,b,d);
    }
    if ($('#eng_edit_flag').val() == 1){
        ng_count += input_eng_check(a,b,d);
    }

    if(ng_count == 0)
    {
        cs_common_edit($('#target_id').val(),a,b,d); //届出CS基本情報登録･更新をするJSを起動(このhtml内にプログラム有)
    }
    else{
        if($("#action_pb_loading") != null){
            $("#action_pb_loading").fadeOut();//呼び出し中に表示するgifをフェードアウト
        }
        // アクションボタン有効化
        $(".button").prop("disabled", false);
    }
}

// 届出進捗状況削除処理
function delete_cs_notification_progress(){
    cs_no = $('#target_id').val();
    $.ajax({
            url: "/isk_tools/fms/action/delete_cs_notification_progress/",
            type: "POST",
            data : {
                'cs_no': cs_no,
                'csrfmiddlewaretoken': "{{ csrf_token }}"
            },
            timeout: 10000,
            dataType: 'json',
            async: false,
            cache: false,
            })
            .done(function(data){
                //alert(data.msg);
            })
           .fail(function(jqXHR,textStatus,errorThrown){
                alert('Error!' +textStatus+' ' +errorThrown);
            });
}

//届出CS基本情報登録･更新処理
function cs_common_edit(a,b,c,d) { //d:action_cd
        var cs_no = a;
        var this_step = b;
        var next_step = c;
        var action_cd = d;
        var next_division = $('#next_division').val();
        var next_department = $('#next_department').val();
        var this_department = $('#user_department_cd').val();
        var this_division = $('#user_division_cd').val();
        var budget_id = $('#target_budget_id').val();
        //var work_id = $('#work_id').val();
        var cs_rev_no = $('#cs_rev_no').val();
        // var related_cs_no= $('#related_cs_no').val();
        var comment = $('#comment').val();
        var budget_charge_id = $('#budget_charge_id').val();
        var budget_charge_comment = $('#budget_charge_comment').val();
        var remand_comment = $('#remand_comment').val();
        var confirmer_id = $('#confirmer_id').val();
        var confirmer_comment = $('#confirmer_comment').val();
        var confirmer_remand_comment = $('#confirmer_remand_comment').val();
        var authorizer_id = $('#authorizer_id').val();
        var authorizer_comment = $('#authorizer_comment').val();
        var authorizer_remand_comment = $('#authorizer_remand_comment').val();
        var wod_charge_id = $('#wod_charge_id').val();
        var wod_charge_comment = $('#wod_charge_comment').val();
        var env_g_confirmer_id_1 = $('#env_g_confirmer_id_1').val();
        var env_g_confirmer_comment_1 = $('#env_g_confirmer_comment_1').val();
        var env_g_confirmer_id_2 = $('#env_g_confirmer_id_2').val();
        var env_g_confirmer_comment_2 = $('#env_g_confirmer_comment_2').val();
        var env_g_authorizer_id = $('#env_g_authorizer_id').val();
        var env_g_authorizer_comment = $('#env_g_authorizer_comment').val();
        var hse_director_id = $('#hse_director_id').val();
        var hse_director_comment = $('#hse_director_comment').val();
        var hse_director_remand_comment = $('#hse_director_remand_comment').val();
        var ed_director_id = $('#ed_director_id').val();
        var ed_director_comment = $('#ed_director_comment').val();
        var hs_director_id = $('#hs_director_id').val();
        var hs_director_comment = $('#hs_director_comment').val();
        var wod_director_id = $('#wod_director_id').val();
        var wod_director_comment = $('#wod_director_comment').val();
        var gad_director_id = $('#gad_director_id').val();
        var gad_director_comment = $('#gad_director_comment').val();
        var cd_director_id = $('#cd_director_id').val();
        var cd_director_comment = $('#cd_director_comment').val();
        var env_department_id = $('#env_department_id').val();
        var env_department_comment = $('#env_department_comment').val();
        var hs_department_id = $('#hs_department_id').val();
        var hs_department_comment = $('#hs_department_comment').val();
        var wo_department_id = $('#wo_department_id').val();
        var wo_department_comment = $('#wo_department_comment').val();
        var ga_department_id = $('#ga_department_id').val();
        var ga_department_comment = $('#ga_department_comment').val();
        var constr_department_id = $('#constr_department_id').val();
        var constr_department_comment = $('#constr_department_comment').val();
        var entry_on_progress_flag = $('#entry_on_progress_flag').val();
        // var entry_datetime = $('#entry_datetime').val();
        // var entry_operator = $('#entry_operator').val();
        var update_datetime = $('#update_datetime').val();
        var update_operator = $('#update_operator').val();

        if ( b == c && d == 'temporarily_saved'){
            var next_person = $('#this_user').val();
            var user_attribute_id = 0;
        }else{
            var next_person = "";
            var user_attribute_id = $('#sel_next_person').val();
        }
        $.ajax({
                url: "/isk_tools/fms/action/cs_common_entry/",
                type: "POST",
                data : {
                    'this_step' : this_step,
                    'next_step' : next_step,
                    'next_division' : next_division,
                    'next_department' : next_department,
                    'user_attribute_id' : user_attribute_id,
                    'next_person' : next_person,
                    'this_division' : this_division,
                    'this_department' : this_department,
                    'authorizer_id' : authorizer_id,
                    'comment' : comment,
                    'action_cd': action_cd,
                    'budget_id' : budget_id,
                    //'work_id' : work_id,
                    'cs_no' : cs_no,
                    'cs_rev_no' : cs_rev_no,
                    'budget_charge_id' : budget_charge_id,
                    'budget_charge_comment' : budget_charge_comment,
                    'remand_comment' : remand_comment,
                    'confirmer_id' : confirmer_id,
                    'confirmer_comment' : confirmer_comment,
                    'confirmer_remand_comment' : confirmer_remand_comment,
                    'authorizer_id' : authorizer_id,
                    'authorizer_comment' : authorizer_comment,
                    'authorizer_remand_comment' : authorizer_remand_comment,
                    'wod_charge_id' : wod_charge_id,
                    'wod_charge_comment' : wod_charge_comment,
                    'env_g_confirmer_id_1' : env_g_confirmer_id_1,
                    'env_g_confirmer_comment_1' : env_g_confirmer_comment_1,
                    'env_g_confirmer_id_2' : env_g_confirmer_id_2,
                    'env_g_confirmer_comment_2' : env_g_confirmer_comment_2,
                    'env_g_authorizer_id' : env_g_authorizer_id,
                    'env_g_authorizer_comment' : env_g_authorizer_comment,
                    'hse_director_id' : hse_director_id,
                    'hse_director_comment' : hse_director_comment,
                    'hse_director_remand_comment' : hse_director_remand_comment,
                    'ed_director_id' : ed_director_id,
                    'ed_director_comment' : ed_director_comment,
                    'hs_director_id' : hs_director_id,
                    'hs_director_comment' : hs_director_comment,
                    'wod_director_id' : wod_director_id,
                    'wod_director_comment' : wod_director_comment,
                    'gad_director_id' : gad_director_id,
                    'gad_director_comment' : gad_director_comment,
                    'cd_director_id' : cd_director_id,
                    'cd_director_comment' : cd_director_comment,
                    'env_department_id' : env_department_id,
                    'env_department_comment' : env_department_comment,
                    'hs_department_id' : hs_department_id,
                    'hs_department_comment' : hs_department_comment,
                    'wo_department_id' : wo_department_id,
                    'wo_department_comment' : wo_department_comment,
                    'ga_department_id' : ga_department_id,
                    'ga_department_comment' : ga_department_comment,
                    'constr_department_id' : constr_department_id,
                    'constr_department_comment' : constr_department_comment,
                    'entry_on_progress_flag' : entry_on_progress_flag,
                    // 'entry_datetime' : entry_datetime,
                    // 'entry_operator' : entry_operator,
                    'update_datetime' : update_datetime,
                    'update_operator' : update_operator,
                    'csrfmiddlewaretoken': "{{ csrf_token }}"
                },
                timeout: 10000,
                dataType: 'json',
                cache : false,
                })
                .done(function(data){
                    //新規登録、リビジョン変更時 画面のinputに反映
                    var this_cs_id = data.cs_no
                    $('#cs_no').val(this_cs_id);
                    $('#target_id').val(this_cs_id);
                    var this_cs_rev_no = data.cs_rev_no
                    $('#cs_rev_no').val(this_cs_rev_no);
                    var this_budget_id = data.budget_id;
                    $('#target_budget_id').val(this_budget_id);

                    /// 各タブの保存処理を呼び出し、完了を待つ(edit判定は各関数内で行う)
                    $.when(
                        cs_ga_edit(this_step,next_step),
                        cs_sh_edit(this_step,next_step),
                        cs_env_edit(this_step,next_step),
                        cs_eng_edit(this_step,next_step)
                    )
                    .done(function() {
                        if (action_cd == 'entry_permit'){
                            target_id = $('#target_id').val();
                            go_next(this_step,next_step,action_cd,target_id,next_division,next_department,user_attribute_id
                                    ,this_department,this_division,comment,'cs',budget_id)
                        }else{
                            //今の工程と次の工程が違う場合の処理
                            if (!( this_step == next_step && action_cd == 'temporarily_saved')){
                                $('#cs_action_button').empty();//操作ボタンを非表示
                            }

                            log_list(4);//ログ表示のためのJS起動(detail_template.html内にプログラム有)

                            if($("#action_pb_loading") != null){
                                $("#action_pb_loading").fadeOut();//呼び出し中に表示するgifをフェードアウト
                            }
                            alert(data.msg);
                        }
                        // アクションボタン有効化
                        $(".button").prop("disabled", false);
                    })
                    .fail(function() {
                        // アクションボタン有効化
                        $(".button").prop("disabled", false);
                    });

                })
               .fail(function(jqXHR,textStatus,errorThrown){
                    if($("#action_pb_loading") != null){
                        $("#action_pb_loading").fadeOut();//呼び出し中に表示するgifをフェードアウト
                    }
                    alert('Error!' +textStatus+' ' +errorThrown);
                    // アクションボタン有効化
                    $(".button").prop("disabled", false);
                });
}
function cs_action_button_empty() {
    $('#cs_action_button').empty();
}

//次届出CS移動ボタン表示処理
function next_button_display() {
    //sessionStorageからリスト絞込条件取得
    var sel_step = sessionStorage.getItem('sel_cs_step');
    var sel_business_year = sessionStorage.getItem('sel_cs_business_year');
    var sel_budget_id = sessionStorage.getItem('sel_cs_budget_id');
    var sel_budget_no = sessionStorage.getItem('sel_cs_budget_no');
    var sel_budget_name = sessionStorage.getItem('sel_cs_budget_name');
    var sel_division = sessionStorage.getItem('sel_cs_division');
    var sel_department = sessionStorage.getItem('sel_cs_department');
    var sel_next_division = sessionStorage.getItem('sel_cs_next_division');
    var sel_next_department = sessionStorage.getItem('sel_cs_next_department');
    var sel_next_parson = sessionStorage.getItem('sel_cs_next_parson');
    var sel_on_work = sessionStorage.getItem('sel_cs_on_work');
    var sel_cs_non_hold = sessionStorage.getItem('sel_cs_non_hold');
    var sel_display_order = sessionStorage.getItem('sel_budget_display_order');

    //表示中のID取得
    var target_cs_no = $('#target_id').val();
    var level5_step_id = $('#level5_step_id').val();

        $.ajax({
                url: "/isk_tools/fms/parts/check_sheet/next_button_display/",
                type: "POST",
                data : {
                    'sel_step' : sel_step,
                    'sel_business_year' : sel_business_year,
                    'sel_budget_id' : sel_budget_id,
                    'sel_budget_no' : sel_budget_no,
                    'sel_budget_name' : sel_budget_name,
                    'sel_division' : sel_division,
                    'sel_department' : sel_department,
                    'sel_next_division' : sel_next_division,
                    'sel_next_department' : sel_next_department,
                    'sel_next_parson' : sel_next_parson,
                    'sel_on_work' : sel_on_work,
                    'sel_cs_non_hold' : sel_cs_non_hold,
                    'sel_display_order' : sel_display_order,
                    'level5_step_id' : level5_step_id,
                    'target_cs_no' : target_cs_no,
                    'csrfmiddlewaretoken': "{{ csrf_token }}"
                },
                timeout: 10000,
                dataType: 'html',
                cache : false,
                })
                .done(function(data){
                    $("#cs_next_button").empty();
                    $("#cs_next_button").html(data);
                })
               .fail(function(jqXHR,textStatus,errorThrown){
                    $("#cs_next_button").empty();
                    alert('Error!' +textStatus+' ' +errorThrown);
                });
}
//画面表示時の処理
window.onload = function() {
        action_button_display();//操作ボタン表示のためのJS起動(このhtml内にプログラム有)
        cs_related_laws_lists_info();
        budget_detail_info();
        cs_general_affairs_info();//総務管轄法令を表示するJSを起動(このhtml内にプログラム有)
        cs_safety_health_data_info();//安全衛生管轄法令を表示するJSを起動(このhtml内にプログラム有)
        cs_environment_data_info();//環境管轄法令を表示するJSを起動(このhtml内にプログラム有)
        cs_engineering_data_info();//工務管轄法令を表示するJSを起動(このhtml内にプログラム有)
        cs_log_info();//届出チェックシートメッセージ情報を表示するJSを起動(このhtml内にプログラム有)
        if ($('#budget_id_edit_flg') == 1){
            budget_id_value_change();//予算IDのコンボボックスの選択を呼び出した値(引数?)と同期
        }
{% if next_button_display_flag == 1 %}
    next_button_display();//次届出CSへの移動ボタン表示処理(このhtml内にプログラム有)
{% endif %}

};
</script>
<style type="text/css">
textarea {
    font-size: 110%;
}
.page-header2 {
    font-size: 150%;
}
#sel_budget_id{
    font-size: 150%;
}
#txt_budget_id{
    font-size: 150%;
}
</style>
    <div style="width: auto;">
        <div style="float:left">
            <div class="fms_col-sm-9 fms_col-sm-offset-3 fms_col-md-10 fms_c0l-md-offset-2 main">
                <h2 class="page-header2">{{ step_name }}</h2>
            </div>
        </div>
        <div style="float:right;">
            <input TYPE=button VALUE=前の画面に戻る NAME=disp_return size=3 style="width:120px" onclick="level5_toppage({{ level5_step_id }});"/>
        </div>
    </div>
    <div style="clear: both;" ></div>
    <div style="width: auto;">
        <input type="hidden" id="target_unique_id" value="{{ target_unique_cs_id }}" >
        <input type="hidden" id="target_budget_id" value="{{ budget_id }}" >
        <input type="hidden" id="target_budget_unique_id" value="{{ budget_unique_id }}" >
        <input type="hidden" id="target_work_id" value="0" >
        <input type="hidden" id="budget_id_edit_flg" value="{{ budget_id_edit_flg }}" >
        <input type="hidden" id="budget_id_list" value="{{ budget_id_list }}" >
        <input type="hidden" id="budget_name" value="{{ budget_name }}" >
        <input type="hidden" id="target_id" value="{{ target_id }}" >
        <input type="hidden" id="target_cs_rev_no" value="{{ cs_rev_no }}" >
        <input type="hidden" id="target_step_id" value="{{ target_step_id }}" >
        <input TYPE="hidden" id="user_division_cd" VALUE="{{user_division_cd}}" NAME=user_division_cd size=3 style="width:150px; height:20px"/>
        <input TYPE="hidden" id="user_department_cd" VALUE="{{user_department_cd}}" NAME=user_department_cd size=3 style="width:150px; height:20px"/>
        <input TYPE="hidden" id="user_authority" VALUE="{{user_authority}}" NAME=user_authority size=3 style="width:150px; height:20px"/>
        <input TYPE="hidden" id="confirm_user" VALUE="{{confirm_user}}" NAME=confirm_user size=3 style="width:150px; height:20px"/>
        <input TYPE="hidden" id="permit_user" VALUE="{{permit_user}}" NAME=permit_user size=3 style="width:150px; height:20px"/>
        <input TYPE="hidden" id="level5_step_id" VALUE="{{level5_step_id}}" NAME=level5_step_id size=3 style="width:150px; height:20px"/>
        <input type="hidden" id="next_division" value="{{ next_division }}">
        <input type="hidden" id="next_department" value="{{ next_department }}">
        <input type="hidden" id="this_step" value="{{ this_step }}">
        <input type="hidden" id="last_operation_step" value="{{ last_operation_step }}">
        <input type="hidden" id="last_operator" value="{{ last_operator }}">
        <input type="hidden" id="this_department" value="{{ this_department }}">
        <input type="hidden" id="this_division" value="{{ this_division }}">
        <input type="hidden" id="last_operator_department" value="{{ last_operator_department }}">
        <input type="hidden" id="last_operator_division" value="{{ last_operator_division }}">
        <input type="hidden" id="target" value="{{ target }}">
        <input type="hidden" id="function_amount" value="{{ function_amount }}">
        <input type="hidden" id="tab_num" value="{{ tab_num }}">
        <input type="hidden" id="default_tab" value="{{ default_tab }}">
        <input type="hidden" id="selected_required_function_id" value="{{ selected_required_function_id }}" >
        <input type="hidden" id="select_tab" value="{{ select_tab }}" >
        <input type="hidden" id="related_cs_no" value="{{ related_cs_no }}" >
        <input type="hidden" id="lost_flag" value="{{ lost_flag }}" >
        <input type="hidden" id="budget_charge_id" value="{{ budget_charge_id }}" >
        <input type="hidden" id="budget_charge_comment" value="{{ budget_charge_comment }}" >
        <input type="hidden" id="remand_comment" value="{{ remand_comment }}" >
        <input type="hidden" id="confirmer_id" value="{{ confirmer_id }}" >
        <input type="hidden" id="confirmer_comment" value="{{ confirmer_comment }}" >
        <input type="hidden" id="confirmer_remand_comment" value="{{ confirmer_remand_comment }}" >
        <input type="hidden" id="authorizer_id" value="{{ authorizer_id }}" >
        <input type="hidden" id="authorizer_comment" value="{{ authorizer_comment }}" >
        <input type="hidden" id="authorizer_remand_comment" value="{{ authorizer_remand_comment }}" >
        <input type="hidden" id="wod_charge_id" value="{{ wod_charge_id }}" >
        <input type="hidden" id="wod_charge_comment" value="{{ wod_charge_comment }}" >
        <input type="hidden" id="env_g_confirmer_id_1" value="{{ env_g_confirmer_id_1 }}" >
        <input type="hidden" id="env_g_confirmer_comment_1" value="{{ env_g_confirmer_comment_1 }}" >
        <input type="hidden" id="env_g_confirmer_id_2" value="{{ env_g_confirmer_id_2 }}" >
        <input type="hidden" id="env_g_confirmer_comment_2" value="{{ env_g_confirmer_comment_2 }}" >
        <input type="hidden" id="env_g_authorizer_id" value="{{ env_g_authorizer_id }}" >
        <input type="hidden" id="env_g_authorizer_comment" value="{{ env_g_authorizer_comment }}" >
        <input type="hidden" id="hse_director_id" value="{{ hse_director_id }}" >
        <input type="hidden" id="hse_director_comment" value="{{ hse_director_comment }}" >
        <input type="hidden" id="hse_director_remand_comment" value="{{ hse_director_remand_comment }}" >
        <input type="hidden" id="ed_director_id" value="{{ ed_director_id }}" >
        <input type="hidden" id="ed_director_comment" value="{{ ed_director_comment }}" >
        <input type="hidden" id="hs_director_id" value="{{ hs_director_id }}" >
        <input type="hidden" id="hs_director_comment" value="{{ hs_director_comment }}" >
        <input type="hidden" id="wod_director_id" value="{{ wod_director_id }}" >
        <input type="hidden" id="wod_director_comment" value="{{ wod_director_comment }}" >
        <input type="hidden" id="gad_director_id" value="{{ gad_director_id }}" >
        <input type="hidden" id="gad_director_comment" value="{{ gad_director_comment }}" >
        <input type="hidden" id="cd_director_id" value="{{ cd_director_id }}" >
        <input type="hidden" id="cd_director_comment" value="{{ cd_director_comment }}" >
        <input type="hidden" id="env_department_id" value="{{ env_department_id }}" >
        <input type="hidden" id="env_department_comment" value="{{ env_department_comment }}" >
        <input type="hidden" id="hs_department_id" value="{{ hs_department_id }}" >
        <input type="hidden" id="hs_department_comment" value="{{ hs_department_comment }}" >
        <input type="hidden" id="wo_department_id" value="{{ wo_department_id }}" >
        <input type="hidden" id="wo_department_comment" value="{{ wo_department_comment }}" >
        <input type="hidden" id="ga_department_id" value="{{ ga_department_id }}" >
        <input type="hidden" id="ga_department_comment" value="{{ ga_department_comment }}" >
        <input type="hidden" id="constr_department_id" value="{{ constr_department_id }}" >
        <input type="hidden" id="constr_department_comment" value="{{ constr_department_comment }}" >
        <input type="hidden" id="entry_on_progress_flag" value="{{ entry_on_progress_flag }}" >
        <input type="hidden" id="entry_datetime" value="{{ entry_datetime }}" >
        <input type="hidden" id="entry_operator" value="{{ entry_operator }}" >
        <input type="hidden" id="update_datetime" value="{{ update_datetime }}" >
        <input type="hidden" id="update_operator" value="{{ update_operator }}" >
        <input type="hidden" id="return_log_count" value="{{return_log_count}}">
        <input type="hidden" id="comment_log_count" value="{{comment_log_count}}">
    </div>
{% if target_step_id == 134001011 or target_step_id == 135001011 %}
    <h2>確認ボタンを押す際は下部の次工程を選択ください。承認ボタンを押すと次部署欄・次作業者欄は関係なく、所管部署確認へ移行します。</h2>
{% endif %}
    <div id="cs_action_button" style="width: auto;"></div>
    <div id="cs_next_button" style="width: auto;"></div>
    <div class='clear'></div>
    <div>
        <font size="5">対象予算:</font>
    </div>

    <div id="{{ div_id_name }}_ng_character_check"><!--ng_character_check ここから-->

    <div>
        {% if budget_id_edit_flg == 1 %}

            <div class="item" style="float:left;margin-left:15px;">年度：<select style="background-color:#FFFFFF;" id="sel_cs_business_year" name="sel_cs_business_year" onchange="cs_budget_id_filter()">
                <option value=""></option>
                    {% for business_year_list in business_year_list %}
                        <option value="{{ business_year_list.business_year }}">{{ business_year_list.business_year }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="item" style="float:left;margin-left:15px;">予算ID：<input type="text" id="sel_cs_budget_id" value="" size="9" onchange="cs_budget_id_filter()"></div>
            <div class="item" style="float:left;margin-left:15px;">予算NO：<input type="text" id="sel_cs_budget_no" value="" size="9" onchange="cs_budget_id_filter()"></div>
            <div class="item" style="float:left;margin-left:15px;">部門：<select style="background-color:#FFFFFF;" id="sel_cs_division" name="sel_cs_division" onchange="cs_department_list_filter(value)">
                <option value=""></option>
                    {% for division_list in division_list %}
                        <option value="{{ division_list.division_cd }}">{{ division_list.division_name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div id="cs_filter_department" class="item" style="float:left;margin-left:15px;">部署：<select style="background-color:#FFFFFF;" id="sel_cs_department" name="sel_cs_department" onchange="cs_budget_id_filter()">
                <option value=""></option>
                    {% for departments_list in departments_list %}
                        <option value="{{ departments_list.department_cd }}">{{ departments_list.department_name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div id="cs_filter_budget_class" class="item" style="float:left;margin-left:15px;">工事区分：<select style="background-color:#FFFFFF;" id="sel_cs_budget_class" name="sel_cs_budget_class" onchange="cs_budget_id_filter()">
                <option value=""></option>
                    {% for budget_class_list in budget_class_list %}
                        <option value="{{ budget_class_list.budget_class_cd }}">{{ budget_class_list.budget_class_name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div id="cs_sel_budget_id" class="item" style="float:left;margin-left:15px;">対象予算：<select id="sel_budget_id" name="sel_budget_id" onchange="budget_id_change(value, budget_id_list);">
                    <option hidden value="">対象となる予算を選択してください</option>
                        {% for budget_id_list in budget_id_list %}
                            <option id="{{ budget_id_list.id }}" value="{{ budget_id_list.budget_id }}">予算ID:{{ budget_id_list.budget_id }}　予算名:{{ budget_id_list.budget_name }}</option>
                        {% endfor %}
                </select>
            </div>
        {% else %}
            <input type="text" id="txt_budget_id" value="予算ID:{{ budget_id }}　予算名:{{ budget_name }}" size="80" maxlength="60" disabled>
            {% if return_log_count > 0 %}
                <font size="5" color="yellow" style="background-color:red">差戻</font>
            {% endif %}
            {% if comment_log_count > 0 %}
                <font size="5" color="orange" style="background-color:green">コメント有</font>
            {% endif %}
        {% endif %}
    </div>

    </div><!--ng_character_checkここまで-->

    <div class='clear'></div>

    <ul id="tab" style="width: auto;">
        {% for page_item in page_lists %}
            <li><a href="#page{{ page_item.page }}">{{ page_item.item_name }}</a></li>
        {% endfor %}
    </ul>

    {% for page_item in page_lists %}
        <div id="page{{ page_item.page }}" class="pagetitle">
            <div id="{{ page_item.div_id_name }}" style="width: auto"></div>
        </div>
    {% endfor %}

<script type="text/javascript">
    var tab_num = $('#tab_num').val();
    var default_tab = $('#default_tab').val();
    tab.setup = {
        tabs: document.getElementById('tab').getElementsByTagName('li'),
            pages: [
    {% for page_item in page_lists %}
                    document.getElementById('page{{ page_item.page }}'),
    {% endfor %}
            ]
    }
    tab.init(default_tab);
</script>

{% endblock %}